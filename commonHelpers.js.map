{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\r\n\r\nimport axios from 'axios';\r\n\r\nconst apiKey = '43846975-899ff2de6e56efd8caf6f887c';\r\nconst apiBase = 'https://pixabay.com/api/';\r\nconst imageType = 'photo';\r\nconst orientation = 'horizontal';\r\n\r\nasync function fetchImages({ searchString, page = 1, perPage = 15 }) {\r\n  let response;\r\n  try {\r\n    response = await axios.get(\r\n      `${apiBase}?key=${apiKey}&q=${searchString\r\n        .split(' ')\r\n        .join(\r\n          '+'\r\n        )}&image_type=${imageType}&orientation=${orientation}&page=${page}&per_page=${perPage}`\r\n    );\r\n    return response;\r\n  } catch (e) {\r\n    throw new Error(e);\r\n  }\r\n}\r\n\r\nexport default fetchImages;\r\n","'use strict';\r\n\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nconst gallery = document.querySelector('.gallery');\r\nconst lightbox = new SimpleLightbox('.gallery a');\r\n\r\nfunction renderGallery(images, newQuery = true) {\r\n  const content = images\r\n    .map(image => {\r\n      return `\r\n            <li class=\"gallery-item\">\r\n                <a href=\"${image.url}\">\r\n                    <div class=\"image-wrapper\">\r\n                        <img\r\n                            src=\"${image.preview}\"\r\n                            alt=\"${image.tags}\"\r\n                        />\r\n                    </div>\r\n                    <div class=\"image-info\">\r\n                        <div class=\"option likes\">\r\n                            <div class=\"key\">Likes</div>\r\n                            <div class=\"value\">${image.likes}</div>\r\n                        </div>\r\n                        <div class=\"option views\">\r\n                            <div class=\"key\">Views</div>\r\n                            <div class=\"value\">${image.views}</div>\r\n                        </div>\r\n                        <div class=\"option comments\">\r\n                            <div class=\"key\">Comments</div>\r\n                            <div class=\"value\">${image.comments}</div>\r\n                        </div>\r\n                        <div class=\"option downloads\">\r\n                            <div class=\"key\">Downloads</div>\r\n                            <div class=\"value\">${image.comments}</div>\r\n                        </div>\r\n                    </div>\r\n                </a>\r\n            </li>\r\n        `;\r\n    })\r\n    .join('');\r\n\r\n  if (newQuery) {\r\n    resetGallery();\r\n  }\r\n  gallery.insertAdjacentHTML('beforeend', content);\r\n  lightbox.refresh();\r\n}\r\n\r\nexport function resetGallery() {\r\n  gallery.innerHTML = '';\r\n}\r\n\r\nexport function hideBtnMore() {\r\n  document.querySelector('.more').classList.add('hide');\r\n}\r\n\r\nexport function showBtnMore() {\r\n  document.querySelector('.more').classList.remove('hide');\r\n}\r\n\r\nexport default renderGallery;\r\n","'use strict';\r\n\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\nimport fetchImages from './js/pixabay-api';\r\nimport renderGallery, {\r\n  hideBtnMore,\r\n  resetGallery,\r\n  showBtnMore,\r\n} from './js/render-functions';\r\n\r\nconst notFoundImages =\r\n  'Sorry, there are no images matching your search query. Please try again!';\r\n\r\nlet userInputData = null;\r\n\r\nconst container = document.querySelector('.container');\r\nconst form = container.querySelector('form.form');\r\n\r\nlet page = 1;\r\nconst loader = '<span class=\"loader\"></span>';\r\n\r\nform.addEventListener('submit', async e => {\r\n  e.preventDefault();\r\n\r\n  const { search } = e.target.elements;\r\n  userInputData = search.value.trim();\r\n\r\n  if (!userInputData) return false;\r\n\r\n  container.insertAdjacentHTML('beforeend', loader);\r\n  resetGallery();\r\n  hideBtnMore();\r\n  page = 1;\r\n\r\n  try {\r\n    const response = await fetchImages({ searchString: search.value.trim() });\r\n    const images = response.data.hits.map(image => transformData(image));\r\n\r\n    if (images.length) {\r\n      renderGallery(images);\r\n      showBtnMore();\r\n    } else {\r\n      iziToast.error({\r\n        title: 'No item found',\r\n        message: notFoundImages,\r\n      });\r\n    }\r\n  } catch (e) {\r\n    iziToast.error({\r\n      title: 'Ooops',\r\n      message: 'Some error occured. Please, try later',\r\n    });\r\n  }\r\n\r\n  form.reset();\r\n  resetFormLoader();\r\n});\r\n\r\ncontainer.addEventListener('click', async e => {\r\n  if (e.target.classList.contains('more') && userInputData) {\r\n    container.insertAdjacentHTML('beforeend', loader);\r\n    hideBtnMore();\r\n    let totalHits = null;\r\n\r\n    const cardHeight = parseFloat(\r\n      document\r\n        .querySelector('.gallery-item')\r\n        .getBoundingClientRect()\r\n        .height.toFixed(1)\r\n    );\r\n\r\n    page += 1;\r\n\r\n    try {\r\n      const response = await fetchImages({\r\n        searchString: userInputData,\r\n        page,\r\n      });\r\n      const images = response.data.hits.map(image => transformData(image));\r\n      totalHits = response.data.totalHits;\r\n\r\n      showBtnMore();\r\n      renderGallery(images, false);\r\n\r\n      window.scrollBy({\r\n        top: cardHeight * 2,\r\n        behavior: 'smooth',\r\n      });\r\n    } catch (e) {\r\n      iziToast.error({\r\n        title: 'Ooops',\r\n        message: 'Some error occured. Please, try later',\r\n      });\r\n    }\r\n\r\n    if (\r\n      totalHits &&\r\n      totalHits === document.querySelectorAll('.gallery-item').length\r\n    ) {\r\n      iziToast.warning({\r\n        title: 'Oops',\r\n        message: \"We're sorry, but you've reached the end of search results.\",\r\n      });\r\n      hideBtnMore();\r\n    }\r\n    resetFormLoader();\r\n  }\r\n});\r\n\r\nfunction transformData(image) {\r\n  return {\r\n    preview: image.webformatURL,\r\n    url: image.largeImageURL,\r\n    tags: image.tags,\r\n    likes: image.likes,\r\n    comments: image.comments,\r\n    downloads: image.downloads,\r\n    views: image.views,\r\n  };\r\n}\r\n\r\nfunction resetFormLoader() {\r\n  const loader = document.querySelector('.loader');\r\n  loader ? loader.remove() : null;\r\n}\r\n"],"names":["apiKey","apiBase","imageType","orientation","fetchImages","searchString","page","perPage","response","axios","gallery","lightbox","SimpleLightbox","renderGallery","images","newQuery","content","image","resetGallery","hideBtnMore","showBtnMore","notFoundImages","userInputData","container","form","loader","e","search","transformData","iziToast","resetFormLoader","totalHits","cardHeight"],"mappings":"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"}